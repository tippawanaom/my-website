<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard ตัวชี้วัด KPI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
  <style>
    body { background-color: #fffaf5; font-family: 'Prompt', sans-serif; padding-bottom: 50px; }
    .navbar { background-color: #f57c00; }
    .nav-link, .navbar-brand { color: white !important; }
    h2 { color: #f57c00; margin-top: 30px; }
    .table thead { background-color: #ffe0b2; }
    .table th, .table td { text-align: center; vertical-align: middle; }
    .btn-orange { background-color: #f57c00; color: white; border: none; }
    .btn-orange:hover { background-color: #e65100; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="#">KPI โรงพยาบาล</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#">ตัวชี้วัด</a></li>
          <li class="nav-item"><a class="nav-link" href="#">รายงาน</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-5">
    <h3>Dashboard ตัวชี้วัดประเด็นตรวจราชการ</h3>
    <h2 class="text-center">ตารางตัวชี้วัด KPI ปีงบประมาณ 2026</h2>
    <div class="table-responsive mt-4" id="kpi-table-container">
      <div class="text-center text-muted">กำลังโหลดข้อมูลจาก Google Sheets...</div>
    </div>

    <div class="text-end mt-3">
      <a href="Untitled-1.html" class="btn btn-orange">หน้าหลัก</a>
    </div>
  </div>

  <script>
    // เปลี่ยนเป็นลิงก์ pubhtml หลังจากเผยแพร่
    const publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1EHEJjaVOx2wQkDSlUhMhWbSHtJTkkH9Ua7wdgDsvJTA/pubhtml';

    window.addEventListener('DOMContentLoaded', () => {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: showInfo,
        simpleSheet: true
      });
    });

    function showInfo(data) {
      const container = document.getElementById("kpi-table-container");

      if (!data || data.length === 0) {
        container.innerHTML = '<p class="text-danger">ไม่พบข้อมูล</p>';
        return;
      }

      let html = '<table class="table table-bordered"><thead><tr>';
      const headers = Object.keys(data[0]);
      headers.forEach(h => {
        html += `<th>${h}</th>`;
      });
      html += '</tr></thead><tbody>';

      data.forEach(row => {
        html += '<tr>';
        headers.forEach(h => {
          html += `<td>${row[h] || ''}</td>`;
        });
        html += '</tr>';
      });

      html += '</tbody></table>';
      container.innerHTML = html;
    }
  </script>
</body>
</html>
